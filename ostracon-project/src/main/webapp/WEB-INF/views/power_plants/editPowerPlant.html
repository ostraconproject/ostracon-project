<form th:action="@{/editPowerPlant}" th:object="${powerPlantForm}" method="post">

	<input type="hidden" th:field="*{plantId}"/>
	
	<div class="modal-dialog modal-md">
		<div class="modal-content">
			<div class="modal-header">
		    	<button type="button" class="close" data-dismiss="modal" aria-label="Close" disabled="disabled"><span data-dismiss="modal" aria-hidden="true">&times;</span></button>
		        <h4 class="inline-block modal-title" id="myModalLabel">Editing Power Plant</h4>
			</div>
			<div class="modal-body" id="">
				<div class="form-group row">
					<div class="col-sm-12" th:classappend="${#fields.hasErrors('name')}? 'has-error'">
						<label>Name</label>
						<input type="text" class="form-control" id="name-input" th:field="*{name}"/>
						<span class="help-block" style="color:red;" th:if="${#fields.hasErrors('name')}" th:errors="*{name}">Empty name</span>
					</div>
				</div>
			</div>
			<div class="modal-body" id="">
				<div class="form-group row">
					<div class="col-sm-12" th:classappend="${#fields.hasErrors('year')}? 'has-error'">
						<label>Year</label>
						<input type="text" class="form-control" id="year-input" th:field="*{year}"/>
						<span class="help-block" style="color:red;" th:if="${#fields.hasErrors('year')}" th:errors="*{year}">Empty year</span>
					</div>
				</div>
			</div>
			
			<div class="modal-body" id="">
				<div class="form-group row">
					<div class="col-sm-12" th:classappend="${#fields.hasErrors('fuelType')}? 'has-error'">
						<label>Fuel Type</label>
					  	<select class="form-control" id="fuel-input" th:field="*{fuelType}">
							<option th:each="fuelType : ${fuelTypes}"
									th:value="${fuelType}" 
									th:text="${fuelType}">
							</option>
						</select>
						<span class="help-block" style="color:red;" th:if="${#fields.hasErrors('fuelType')}" th:errors="*{fuelType}">Empty fuel type</span>
					</div>
				</div>
			</div>
			
			<div class="modal-body" id="">
				<div class="form-group row">
					<div class="col-sm-12" th:classappend="${#fields.hasErrors('country')}? 'has-error'">
						<label>Country</label>
						<input type="text" class="form-control" id="country-input" th:field="*{country}"/>
						<span class="help-block" style="color:red;" th:if="${#fields.hasErrors('country')}" th:errors="*{country}">Empty country</span>
					</div>
				</div>
			</div>
			<div class="modal-body" id="">
				<div class="form-group row">
					<div class="col-sm-12" th:classappend="${#fields.hasErrors('city')}? 'has-error'">
						<label>City</label>
						<input type="text" class="form-control" id="city-input" th:field="*{city}"/>
						<span class="help-block" style="color:red;" th:if="${#fields.hasErrors('city')}" th:errors="*{city}">Empty city</span>
					</div>
				</div>
			</div>
			<div class="modal-body" id="">
				<div class="form-group row">
					<div class="col-sm-12" th:classappend="${#fields.hasErrors('latitude')}? 'has-error'">
						<label>Latitude</label>
						<input type="text" class="form-control" id="latitude-input" th:field="*{latitude}"/>
						<span class="help-block" style="color:red;" th:if="${#fields.hasErrors('latitude')}" th:errors="*{latitude}">Empty latitude</span>
					</div>
				</div>
			</div>
			<div class="modal-body" id="">
				<div class="form-group row">
					<div class="col-sm-12" th:classappend="${#fields.hasErrors('longitude')}? 'has-error'">
						<label>Longitude</label>
						<input type="text" class="form-control" id="longitude-input" th:field="*{longitude}"/>
						<span class="help-block" style="color:red;" th:if="${#fields.hasErrors('longitude')}" th:errors="*{longitude}">Empty longitude</span>
					</div>
				</div>
			</div>
			<div class="modal-body" id="">
				<div class="form-group row">
					<div class="col-sm-12" th:classappend="${#fields.hasErrors('capacity')}? 'has-error'">
						<label>Capacity (MW)</label>
						<input type="text" class="form-control" id="capacity-input" th:field="*{capacity}"/>
						<span class="help-block" style="color:red;" th:if="${#fields.hasErrors('capacity')}" th:errors="*{capacity}">Empty capacity</span>
					</div>
				</div>
			</div>
			<div class="modal-body" id="">
				<div class="form-group row">
					<div class="col-sm-12" th:classappend="${#fields.hasErrors('capacityFactor')}? 'has-error'">
						<label>Capacity Factor (%)</label>
						<input type="text" class="form-control" id="factor-input" th:field="*{capacityFactor}"/>
						<span class="help-block" style="color:red;" th:if="${#fields.hasErrors('capacityFactor')}" th:errors="*{capacityFactor}">Empty capacity factor</span>
					</div>
				</div>
			</div>
			<div class="modal-footer">
		    	<h4 class="inline-block no-margin confirmationMessage"></h4>
		    	<div class="pull-right">
		    		<button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
		            <button type="button" class="savePlantConfirm btn btn-success">Save changes</button>
		        </div>
	        </div>
		</div>
	</div>
	
</form>
	
<script>
	$(".savePlantConfirm").click(function(){
		var url = $(this).parents("form").attr("action");
		var data = $(this).parents("form");
		
		$(this).html("Confirm").removeClass("btn-success ").addClass("btn-success savePlantChanges");
		$(".confirmationMessage").html("Are you sure you wish to change this power plant?");
		
		$(".savePlantChanges").click(function(){
			$.ajax({
				url: url,
				type: "post",
				data: data.serialize(),
				success : function(response){
					if (response.redirect) {
			    		window.location.reload();
			    	}else{		
			    		$(".replaceable").html(response);
			    	}
			    },error: function(){
			    }
			});
		});
	});
</script>